Based on the chat example from Socket.io
